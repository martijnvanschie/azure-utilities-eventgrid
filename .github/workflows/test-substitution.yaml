name: .NET

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  build:

    runs-on: ubuntu-latest

    steps:
    - name: Check out the code
      uses: actions/checkout@v2
    - uses: QwerMike/xpath-action@v1
      id: xpath
      with:
        filename: 'cli/EventGrid.Publisher.ConsoleApp/EventGrid.Publisher.ConsoleApp.csproj'
        expression: '//Project/PropertyGroup/FileVersion/text()'
        
    - name: branch
      run: |
        echo "${{ steps.xpath.outputs.result }}"
        echo "SHA 8 = ${GITHUB_SHA::8}"
        echo "SHA 4 = ${GITHUB_SHA::4}"
      
    - name: xml-replace-action
      uses: rvolo/xml-replace-action@v0.3
      with:
        # path in filesystem to xml file
        filepath: 'cli/EventGrid.Publisher.ConsoleApp/EventGrid.Publisher.ConsoleApp.csproj'
        # Xpath to use when getting nodes
        xpath: '//Project/PropertyGroup/FileVersion/text()'
        # value to replace with
        replace: "2.0.0-beta"
